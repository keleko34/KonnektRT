var KonnektRT=function(){var f=function(){var k=require("fs"),f=require("querystring"),B=process.cwd().replace(/\\/g,"/")+"/app";require("path");var q=require(__dirname.replace(/\\/g,"/")+"/../../Stream_Appender/Build/Stream_Appender"),r=q.preappend,w=q.append;return function(){function n(a,c,d){if(0===a.url.indexOf("/component")){a.query||(a.query={});a.stringQuery=n.parseQuery(a.url);-1!==a.url.indexOf("?")&&(a.url=a.url.substring(0,a.url.indexOf("?")));a.url=a.url.replace(".js","");d=0;for(var e=
Object.keys(a.stringQuery),f=e.length;d<f;d++)a.query[e[d]]=a.stringQuery[e[d]];var b=a.url.replace("/component/","").replace(/[\/]/g,""),p=a.query.env||"prod";d=a.query.debug;var z=a.query.edit,A=a.sessions?a.sessions.cms:!1,t=B+"/components/"+b,x=t+("dev"!==p?"/build/"+p+"/"+b+(d?".js":".min.js"):"/"+b+".js"),l,g=0,h=0;k.stat(x,function(a,d){if(!a&&d.isFile())if("dev"===p){var e=function(a,d,e,g){!a&&e&&d?g?(g=g.replace(/(\r)/g,"").replace(/(\n)/g,"\r\n\t"),l.pipe(w("\r\n"+b+".prototype.k_cms = (function(){\r\n\t"+
g+"\r\n\treturn "+b+";\r\n}());\r\n"+b+'.prototype.k_html = "'+d.replace(/[\r\n]/g,"").replace(/[\"]/g,'/"')+'";\r\n'+b+'.prototype.k_css = "'+e.replace(/[\r\n]/g,"").replace(/[\"]/g,'/"')+'";')).pipe(r('if(!K_Components) K_Components = {};\r\nK_Components["'+b+'"] = (function(){\r\n\t',"\r\n\treturn "+b+";\r\n}());")).pipe(c)):l.pipe(w("\r\n"+b+'.prototype.k_html = "'+d.replace(/[\r\n]/g,"").replace(/[\"]/g,'/"')+'";\r\n'+b+'.prototype.k_css = "'+e.replace(/[\r\n]/g,"").replace(/[\"]/g,'/"')+'";')).pipe(r('if(!K_Components) K_Components = {};\r\nK_Components["'+
b+'"] = (function(){\r\n\t',"\r\n\treturn "+b+";\r\n}());")).pipe(c):l.pipe(r('if(!K_Components) K_Components = {};\r\nK_Components["'+b+'"] = (function(){\r\n\t',"\r\n\treturn "+b+";\r\n}());")).pipe(c)};h+=2;l=k.createReadStream(x);var f="",v="",m,u=!1;z&&A&&(h+=1,q(t,b,function(a){g+=1;m=a;g===h&&e(u,f,v,m)}));k.readFile(t+"/"+b+".html","utf8",function(a,b){g+=1;u=!!a;f=b;g===h&&e(u,f,v,m)});k.readFile(t+"/"+b+".css","utf8",function(a,b){g+=1;u=!!a;v=b;g===h&&e(u,f,v,m)})}else{var n=function(a){a?
(a=a.replace(/(\r\n)/g,"\r\n\t"),l.pipe(w("\r\n"+b+".prototype.k_cms = (function(){\r\n\t"+a+"\r\n\treturn "+b+";\r\n}());")).pipe(r('if(!K_Components) K_Components = {};\r\nK_Components["'+b+'"] = (function(){\r\n\t',"\r\n\treturn "+b+";\r\n}());")).pipe(c)):l.pipe(r('if(!K_Components) K_Components = {};\r\nK_Components["'+b+'"] = (function(){\r\n\t',"\r\n\treturn "+b+";\r\n}());")).pipe(c)};l=k.createReadStream(x);z&&A&&(h+=1,q(t,b,function(a){g+=1;m=a;g===h&&n(m)}));0===h&&n(m)}else a&&"ENOENT"===
a.code?"dev"!==p?c.notFound?c.notFound(void 0,"You have not built the component "+b+" into environment "+p):y(c,404,"You have not built the component "+b+" into environment "+p):c.notFound?c.notFound(void 0,"There is no such component by the name "+b):y(c,404,"There is no such component by the name "+b):c.serverError?c.serverError():y(c,500,"Server error")})}else d()}function y(a,c,d){a.statusCode=c;a.statusMessage=d;a.write(d,"utf8",function(){a.end()})}function q(a,c,d){var e=0;k.readFile(a+"/cms/"+
c+".js","utf8",function(f,b){f?d("function "+c+"(){/*There was an error retrieving cms components*/};"):(k.readFile(a+"/cms/"+c+".html","utf8",function(a,f){a?d("function "+c+"(){/*There was an error retrieving cms components*/};"):(b+="\r\n"+c+'.prototype.kcms_html = "'+f.replace(/[\r\n]/g,"")+'";',e+=1,2===e&&d(b))}),k.readFile(a+"/cms/"+c+".css","utf8",function(a,f){a?d("function "+c+"(){/*There was an error retrieving cms components*/};"):(b+="\r\n"+c+'.prototype.kcms_css = "'+f.replace(/[\r\n]/g,
"")+'";',e+=1,2===e&&d(b))}))})}n.parseQuery=function(a){return f.parse(a.substring(a.indexOf("?")+1,a.length))};return n}}();"undefined"!==typeof window&&"undefined"!==typeof window.define&&"undefined"!==typeof window.require?define([],function(){return f}):"undefined"!==typeof module&&(module.exports=f);return f}();
