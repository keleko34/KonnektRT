var KonnektRT=function(){var k=function(){var l=require("fs"),k=require("querystring"),t=process.cwd().replace(/\\/g,"/")+"/app";require("path");var x=require("replacestream");require("stream");require("util");return function(){function n(a,d,c){if(0===a.url.indexOf("/component")){a.query||(a.query={});a.stringQuery=n.parseQuery(a.url);a.url=a.url.substring(0,a.url.indexOf("?"));c=0;for(var g=Object.keys(a.stringQuery);c<g;c++)a.query[a.stringQuery[c]]=a.stringQuery[a.stringQuery[c]];var b=a.url.replace("/component/",
""),m=a.query.env;c=a.query.debug;var u=a.query.edit,k=a.sessions?a.sessions.cms:!1;a="dev"!==m?"/build/"+m+"/"+b+(c?".js":".min.js"):".js";var v=t+"/components/"+b,p=t+"/components/"+b+"/"+("dev"===m?b+a:a),e,f=0,h=0;l.stat(p,function(a,c){!a&&c.isFile()&&("dev"===m?(h+=2,e=l.createReadStream(p),u&&k&&(h+=1,e.pipe(injectProperty(b,"k_cms")),w(v,b,function(a){f+=1})),e.pipe(injectProperty(b,"K_css")).pipe(injectProperty(b,"k_html"))):(e=l.createReadStream(p),u&&k&&(h+=1,e.pipe(injectProperty(b,"k_cms")),
w(v,b,function(a){f+=1;e.pipe(q(e,b,"k_cms","(function(){"+a+"\r\nreturn "+b+";\r\n}())"));f===h&&e.pipe(d)})),e.pipe(injectProperty(b,"K_css")).pipe(injectProperty(b,"k_html")),l.readFile(base+"/"+name+".html","utf8",function(a,c){f+=1;a||e.pipe(injectProperty(b,"k_html")).pipe(q(e,b,"k_html",'"'+c+'"'));f===h&&e.pipe(d)}),l.readFile(base+"/"+name+".css","utf8",function(a,c){f+=1;a||e.pipe(injectProperty(b,"k_css")).pipe(q(e,b,"k_css",'"'+c+'"'));f===h&&e.pipe(d)})));a&&"ENOENT"===a.code?"dev"!==
m?d.notFound?d.notFound(void 0,"You have not built the component "+b+" into environment "+m):r(d,404,"You have not built the component "+b+" into environment "+m):d.notFound?d.notFound(void 0,"There is no such component by the name "+b):r(d,404,"There is no such component by the name "+b):d.serverError?d.serverError():r(d,500,"Server error")})}else c()}function r(a,d,c){a.statusCode=d;a.end(c,"utf8",function(){})}function w(a,d,c){var g=0;l.readFile(a+"/cms/"+d+".js","utf8",function(b,k){b?c("function "+
d+"(){};"):(l.readFile(a+"/cms/"+d+".html","utf8",function(a,b){a?c("function "+d+"(){};"):(g+=1,2===g&&c(contetnMain))}),l.readFile(a+"/cms/"+d+".css","utf8",function(a,b){a?c("function "+d+"(){};"):(g+=1,2===g&&c(contetnMain))}))})}function q(a,d,c,g){return x(d+".prototype."+c+" = ''",d+".prototype."+c+" = "+g)}n.parseQuery=function(a){return k.parse(a.substring(a.indexOf("?")+1,a.length))};return n}}();"undefined"!==typeof window&&"undefined"!==typeof window.define&&"undefined"!==typeof window.require?
define([],function(){return k}):"undefined"!==typeof module&&(module.exports=k);return k}();
