var KonnektRT=function(){var f=function(){var l=require("fs"),f=require("querystring"),B=process.cwd().replace(/\\/g,"/"),c=__dirname.replace(/\\/g,"/")+"/../..";require("path");var c=require(c+"/Stream_Appender/Build/Stream_Appender")(),t=c.preappend,u=c.append;return function(){function c(a,d,e){if(0===a.url.indexOf("/component")){a.query||(a.query={});a.stringQuery=c.parseQuery(a.url);-1!==a.url.indexOf("?")&&(a.url=a.url.substring(0,a.url.indexOf("?")));a.url=a.url.replace(".js","");e=0;for(var h=
Object.keys(a.stringQuery),f=h.length;e<f;e++)a.query[h[e]]=a.stringQuery[h[e]];var b=a.url.replace("/component/","").replace(/[\/]/g,""),p=a.query.env||"prod";e=a.query.debug;var x=a.query.edit,y=a.sessions?a.sessions.cms:!1,q=B+"/components/"+b,v=q+("dev"!==p?"/build/"+p+"/"+b+(e?".js":".min.js"):"/"+b+".js"),m,g=0,k=0;l.stat(v,function(a,e){if(!a&&e.isFile())if("dev"===p){var h=function(a,e,h,c){!a&&h&&e?c?(c=c.replace(/(\r)/g,"").replace(/(\n)/g,"\r\n\t"),m.pipe(u("\r\n"+b+".prototype.k_cms = (function(){\r\n\t"+
c+"\r\n\treturn "+b+";\r\n}());\r\n"+b+'.prototype.k_html = "'+e.replace(/[\r\n]/g,"").replace(/[\"]/g,"'")+'";\r\n'+b+'.prototype.k_css = "'+h.replace(/[\r\n]/g,"").replace(/[\"]/g,"'")+'";')).pipe(t('if(!K_Components) K_Components = {};\r\nK_Components["'+b+'"] = (function(){\r\n\t',"\r\n\treturn "+b+";\r\n}());")).pipe(d)):m.pipe(u("\r\n"+b+'.prototype.k_html = "'+e.replace(/[\r\n]/g,"").replace(/[\"]/g,"'")+'";\r\n'+b+'.prototype.k_css = "'+h.replace(/[\r\n]/g,"").replace(/[\"]/g,"'")+'";')).pipe(t('if(!K_Components) K_Components = {};\r\nK_Components["'+
b+'"] = (function(){\r\n\t',"\r\n\treturn "+b+";\r\n}());")).pipe(d):m.pipe(t('if(!K_Components) K_Components = {};\r\nK_Components["'+b+'"] = (function(){\r\n\t',"\r\n\treturn "+b+";\r\n}());")).pipe(d)};k+=2;m=l.createReadStream(v);var c="",f="",n,r=!1;x&&y&&(k+=1,z(q,b,function(a){g+=1;n=a;g===k&&h(r,c,f,n)}));l.readFile(q+"/"+b+".html","utf8",function(a,b){g+=1;r=!!a;c=b;g===k&&h(r,c,f,n)});l.readFile(q+"/"+b+".css","utf8",function(a,b){g+=1;r=!!a;f=b;g===k&&h(r,c,f,n)})}else{var A=function(a){a?
(a=a.replace(/(\r\n)/g,"\r\n\t"),m.pipe(u("\r\n"+b+".prototype.k_cms = (function(){\r\n\t"+a+"\r\n\treturn "+b+";\r\n}());")).pipe(d)):m.pipe(d)};m=l.createReadStream(v);x&&y&&(k+=1,z(q,b,function(a){g+=1;n=a;g===k&&A(n)}));0===k&&A(n)}else a&&"ENOENT"===a.code?"dev"!==p?d.notFound?d.notFound(void 0,"You have not built the component "+b+" into environment "+p):w(d,404,"You have not built the component "+b+" into environment "+p):d.notFound?d.notFound(void 0,"There is no such component by the name "+
b):w(d,404,"There is no such component by the name "+b):d.serverError?d.serverError():w(d,500,"Server error")})}else e()}function w(a,d,e){a.statusCode=d;a.statusMessage=e;a.write(e,"utf8",function(){a.end()})}function z(a,d,e){var c=0;l.readFile(a+"/cms/"+d+".js","utf8",function(f,b){f?e("function "+d+"(){/*There was an error retrieving cms components*/};"):(l.readFile(a+"/cms/"+d+".html","utf8",function(a,f){a?e("function "+d+"(){/*There was an error retrieving cms components*/};"):(b+="\r\n"+d+
'.prototype.kcms_html = "'+f.replace(/[\r\n]/g,"")+'";',c+=1,2===c&&e(b))}),l.readFile(a+"/cms/"+d+".css","utf8",function(a,f){a?e("function "+d+"(){/*There was an error retrieving cms components*/};"):(b+="\r\n"+d+'.prototype.kcms_css = "'+f.replace(/[\r\n]/g,"")+'";',c+=1,2===c&&e(b))}))})}c.parseQuery=function(a){return f.parse(a.substring(a.indexOf("?")+1,a.length))};return c}}();"undefined"!==typeof window&&"undefined"!==typeof window.define&&"undefined"!==typeof window.require?define([],function(){return f}):
"undefined"!==typeof module&&(module.exports=f);return f}();
